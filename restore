#!/bin/bash
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# ğ“ˆƒ System Request â  Debian 9+/Ubuntu 18.04+/20+
# ğ“ˆƒ Developer â  MikkuChan
# ğ“ˆƒ Email      â  fadztechs2@gmail.com
# ğ“ˆƒ Telegram   â  https://t.me/fadzdigital
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

clear

# Warna ANSI untuk tampilan terminal
RED='\033[1;91m'
GREEN='\033[1;92m'
YELLOW='\033[1;93m'
BLUE='\033[1;94m'
CYAN='\033[1;96m'
NC='\033[0m' # Reset warna

# Konfigurasi Telegram Bot
CHATID=$(grep -E "^#bot# " "/etc/bot/.bot.db" | cut -d ' ' -f 3)
KEY=$(grep -E "^#bot# " "/etc/bot/.bot.db" | cut -d ' ' -f 2)
export TIME="10"
export URL="https://api.telegram.org/bot$KEY/sendMessage"

# Fungsi Notifikasi Restore ke Telegram
function notif_restore() {
    sleep 2
    TEXT="
â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”
ğ“ˆƒ RESTORE VPS BERHASIL ğ“ˆƒ
â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”
âœ… Restore VPS Sukses!
ğŸ“Œ VPS telah dikembalikan seperti semula.
â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”
"
    curl -s --max-time $TIME -d "chat_id=$CHATID&disable_web_page_preview=1&text=$TEXT&parse_mode=html" $URL >/dev/null
}

# Fungsi progress bar dengan animasi
step=1
progress() {
    bar="â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡"
    case $step in
        1) bar="â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡" ;;
        2) bar="â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡" ;;
        3) bar="â– â– â– â– â– â– â– â– â–¡â–¡" ;;
        4) bar="â– â– â– â– â– â– â– â– â– â– " ;;
    esac
    echo -ne "\rğŸ“‚ ${GREEN}$1${NC}   [$bar] $2%"
    step=$((step+1))
    sleep 2
}

clear
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "ğŸ”„ ${CYAN}MEMULAI PROSES RESTORE...${NC}"
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
sleep 1

# Meminta Link Backup
echo -e "${CYAN}Masukkan Link Backup VPS:${NC}"
echo -e "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
read -rp "ğŸ”— Link File: " -e url
echo -e "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

progress "Mengunduh file backup" 10
wget -O backup.zip "$url"

progress "Mengekstrak file backup" 40
unzip backup.zip
rm -f backup.zip

progress "Memulihkan konfigurasi VPS" 80
cd /root/backup
cp passwd /etc/
cp group /etc/
cp shadow /etc/
cp gshadow /etc/
cp -r kyt /etc/
cp -r xray /etc/
cp -r vmess /etc/
cp -r vless /etc/
cp -r trojan /etc/
cp -r shodowshocks /etc/
cp -r html /var/www/
cp crontab /etc/

progress "Finalisasi proses restore" 100
notif_restore
rm -rf /root/backup
rm -f backup.zip

clear
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "âœ… ${GREEN}RESTORE VPS SELESAI${NC}"
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "ğŸ”„ ${CYAN}VPS telah dikembalikan seperti semula.${NC}"
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€»â†â€»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"